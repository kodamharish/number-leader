{% include 'admin/company_profile.html' %}

{% block styles %}
<style>
    .container {
        padding-left: 280px;
        max-width: 100%;
        position: relative;
        overflow-y: auto;
        max-height: 100%;
    }

    .content {
        margin: 40px auto;
        padding-top: 30px;
        padding-left: 200px;
        width: calc(100% - 200px);
    }

    table {
        width: 100%;
        font-family: 'Times New Roman', Times, serif;
        border-collapse: collapse;
        table-layout: fixed;
    }

    th,
    td {
        border: 1px solid #ddd;
        text-align: left !important;
    }

    td {
        text-align: right;
    }

    th {
        background-color: #f2f2f2 !important;
        position: sticky;
        top: 0;
        z-index: 2;
    }

    tr:nth-child(even) {
        background-color: #f9f9f9;
    }

    tr:hover {
        background-color: #f1f1f1;
    }

    .rowview {
        width: 25%;
    }

    .rowview1 {
        width: 10%;
    }
    tr.hidden {
        display: none;
    }

    .indent-level-1 td:first-child {
        padding-left: 2em;
    }

    .indent-level-2 td:first-child {
        padding-left: 4em;
    }

    .indent-level-3 td:first-child {
        padding-left: 6em;
    }

    .indent-level-4 td:first-child {
        padding-left: 8em;
    }
    .table-container {
        max-height: 500px;
        overflow-y: auto;
        overflow-x: auto;
    }
</style>
{% endblock styles %}

{% block content %}
<div class="container  mt-5">
    <div class="row">
        <div class="col-md-4">
            <h6 class="mb-4">
                Corporate Finance -
                {% if request.resolver_match.url_name == 'planning_budgeting_income_statement_table' %}
                Planning & Budgeting
                {% elif request.resolver_match.url_name == 'forecasting_income_statement_table' %}
                Forecasting
                {% endif %}
                - <b>Income Statement</b>
            </h6>
        </div>
        <div class="col-md-4"></div>
        <div class="col-md-4"></div>
        
    </div>
</div>
<div class="container mt-4">

    <form method="POST" action="#" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="table-responsive table-container">
            <table class="table table-bordered table-wrapper">
                <thead>
                    <tr>
                        <th class="rowview">Breakdownss</th> 
                        <th class="rowview1">TTM   {{income_statement.date|date:'d-m-Y'}}</th>
                        <th class="rowview">Definition</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Total Revenue</td>
                        <td><input type="number" class="form-control" id="total_revenue" name="total_revenue" readonly placeholder="00.00"></td>
                        <td>The total income generated from all business activities.</td>
                    </tr>
                    <tr class="indent-level-1">
                        <td>Operating Revenue</td>
                        <td><input type="number" class="form-control" id="operating_revenue" name="operating_revenue" oninput="totalrevenue()"></td>
                        <td>Income earned from the core business operations.</td>
                    </tr>
                    <tr>
                        <td>Cost of Revenue</td>
                        <td><input type="number" class="form-control" id="cost_of_revenue" name="cost_of_revenue" oninput="profit()"></td>
                        <td>The direct costs associated with producing goods or services sold.</td>
                    </tr>
                    <tr>
                        <td>Gross Profit</td>
                        <td><input type="number" class="form-control" id="gross_profit" name="gross_profit" readonly placeholder="00.00"></td>
                        <td>Total revenue minus the cost of revenue.</td>
                    </tr>
                    <tr>
                        <td>Operating Expense</td>
                        <td><input type="number" class="form-control" id="operating_expense" name="operating_expense" readonly placeholder="00.00"></td>
                        <td>Expenses incurred during regular business operations.</td>
                    </tr>
                    <tr class="indent-level-1">
                        <td>Selling, General and Administrative Expense</td>
                        <td><input type="number" class="form-control" id="selling_general_and_administrative_expense" name="selling_general_and_administrative_expense" readonly placeholder="00.00"></td>
                        <td>Overheads related to selling products and managing the business.</td>
                    </tr>
                    <tr  class="indent-level-2">
                        <td>General & Administrative Expenses</td>
                        <td><input type="number" class="form-control" id="general_and_administrative_expenses" name="general_and_administrative_expenses" oninput="sellingexpense()"></td>
                        <td>Costs associated with running the company, excluding production and selling costs.</td>
                    </tr>
                    <tr  class="indent-level-2">
                        <td>Selling and Marketing Expense</td>
                        <td><input type="number" class="form-control" id="selling_and_marketing_expense" name="selling_and_marketing_expense" oninput="sellingexpense()"></td>
                        <td>Costs related to promoting and selling products or services.</td>
                    </tr>

                    <tr class="indent-level-1">
                        <td>Research and Development Expense </td>
                        <td><input type="number" class="form-control" id="research_and_development_expense" name="research_and_development_expense" oninput="marketing()"></td>
                        <td>Costs incurred for researching and developing new products or services.</td>
                    </tr>
                    <tr>
                        <td>Operating Income</td>
                        <td><input type="number" class="form-control" id="operating_income" name="operating_income" readonly placeholder="00.00"></td>
                        <td>Gross profit minus operating expenses.</td>
                    </tr>
                    <tr class="indent-level-1">
                        <td>Net Non Operating Interest Income / Expense</td>
                        <td><input type="number" class="form-control" id="net_non_operating_interest_income_expense" name="net_non_operating_interest_income_expense" readonly placeholder="00.00"></td>
                        <td>Net interest earned or paid from non-operating activities.</td>
                    </tr>
                    <tr class="indent-level-2">
                        <td>Interest Income Non Operating</td>
                        <td><input type="number" class="form-control" id="interest_income_non_operating" name="interest_income_non_operating" oninput="operatingincome()"></td>
                        <td>Interest earned from investments and other non-core activities.</td>
                    </tr>
                    <tr class="indent-level-2">
                        <td>Interest Expense Non Operating</td>
                        <td><input type="number" class="form-control" id="interest_expense_non_operating" name="interest_expense_non_operating" oninput="operatingincome()"></td>
                        <td>Interest paid on non-operating liabilities.</td>
                    </tr>
                    <tr>
                        <td>Other Income/(Expense)</td>
                        <td><input type="number" class="form-control" id="other_income_or_expense" name="other_income_or_expense" readonly placeholder="00.00"></td>
                        <td>Income or expenses not related to core business operations.</td>
                    </tr>
                    <tr class="indent-level-1">
                        <td>Gain/(Loss) on Sale of Security</td>
                        <td><input type="number" class="form-control" id="gain_or_loss_on_sale_of_security" name="gain_or_loss_on_sale_of_security" oninput="expenseincome()"></td>
                        <td>Profit or loss from selling investments.</td>
                    </tr>
                    <tr class="indent-level-1">
                        <td>Special Income/(Charges)</td>
                        <td><input type="number" class="form-control" id="special_income_or_charges" name="special_income_or_charges" oninput="expenseincome()"></td>
                        <td>One-time or unusual gains or expenses.</td>
                    </tr>
                    <tr class="indent-level-1">
                        <td>Write Off</td>
                        <td><input type="number" class="form-control" id="write_off" name="write_off" oninput="expenseincome()"></td>
                        <td>The accounting action of recognizing an asset's reduced or zero value.</td>
                    </tr>
                    <tr class="indent-level-1">
                        <td>Other Non Operating Income/ (Expenses)</td>
                        <td><input type="number" class="form-control" id="other_non_operating_income_or_expenses" name="other_non_operating_income_or_expenses" oninput="expenseincome()"></td>
                        <td>Income or expenses from activities not related to the core business.</td>
                    </tr>
                    <tr>
                        <td>Pretax Income</td>
                        <td><input type="number" class="form-control" id="pretax_income" name="pretax_income" readonly placeholder="00.00"></td>
                        <td>Income before income taxes are deducted.</td>
                    </tr>
                    <tr>
                        <td>Tax Provision</td>
                        <td><input type="number" class="form-control" id="tax_provision" name="tax_provision" oninput="expenseincome()"></td>
                        <td>The estimated amount of income tax expense for a period.</td>
                    </tr> 
                    <tr>
                        <td>Net Income</td>
                        <td><input type="number" class="form-control" id="net_income" name="net_income" readonly placeholder="00.00"></td>
                        <td>The company's total profit after all expenses, including taxes, have been deducted.</td>
                    </tr>
                    <tr>
                        <td>Preference Share Dividends</td>
                        <td><input type="number" class="form-control" id="preference_share_dividends" name="preference_share_dividends" oninput="expenseincome()"></td>
                        <td>Dividends paid to preferred shareholders.</td>
                    </tr>
                    <tr>
                        <td>Net Income to Common Stockholders</td>
                        <td><input type="number" class="form-control" id="net_income_to_common_stockholders" name="net_income_to_common_stockholders" readonly placeholder="00.00"></td>
                        <td>Net income available to common shareholders after preferred dividends.</td>
                    </tr>
                    <tr>
                        <td>Equity Share Dividends</td>
                        <td><input type="number" class="form-control" id="equity_share_dividends" name="equity_share_dividends" oninput="expenseincome()"></td>
                        <td>Dividends paid to equity shareholders.</td>
                    </tr>
                    <tr>
                        <td>Retained Earnings</td>
                        <td><input type="number" class="form-control" id="retained_earnings" name="retained_earnings" readonly placeholder="00.00"></td>
                        <td>Profits reinvested in the business instead of being distributed as dividends.</td>
                    </tr>
                    <tr>
                        <td>No of Equity Shares</td>
                        <td><input type="number" class="form-control" id="no_of_equity_shares" name="no_of_equity_shares"  oninput="expenseincome()"></td>
                    </tr>

                   
                    <tr>
                        <td>Basic EPS</td>
                        <td><input type="number" class="form-control" id="basic_eps" name="basic_eps" readonly placeholder="00.00"></td>
                        <td>Earnings per share calculated using the outstanding shares.</td>
                    </tr>
                    <tr>
                        <td>Diluted EPS</td>
                        <td><input type="number" class="form-control" name="diluted_eps"  oninput="expenseincome()" ></td>
                        <td>Earnings per share calculated using the outstanding shares plus any convertible securities.</td>
                    </tr>
                    <tr>
                        <td>Depreciation and Amortization</td>
                        <td><input type="number" class="form-control" id="depreciation_and_amortization" name="depreciation_and_amortization"  oninput="expenseincome()"></td>
                        <td>Non-cash expenses that reduce the value of tangible and intangible assets over time.</td>
                    </tr>
                    <tr>
                        <td>EBITDA</td>
                        <td><input type="number" class="form-control" id="EBITDA" name="EBITDA" readonly placeholder="00.00"></td>
                        <td>Earnings before interest, taxes, depreciation, and amortization.</td>
                    </tr>
                </tbody>
            </table>
        </div>


        <!-- Button to Add More Advisors -->
        <div class="row mt-5">
            <div class="col-md-12 text-center">
                <button type="submit" class="btn btn-primary" id="submit_income_statement">Submit</button>
            </div>
        </div>

    </form>
</div>
<script>
    function totalrevenue(){
        var revenue=parseFloat(document.getElementById('operating_revenue').value) || 0;

        if (revenue !== null){
            document.getElementById('total_revenue').value=revenue.toFixed(2)

        }

     
    }
    function profit() {
    var costofrevenue = parseFloat(document.getElementById('cost_of_revenue').value) || 0;
    var revenue = parseFloat(document.getElementById('operating_revenue').value) || 0;
    var profit = revenue - costofrevenue;
    document.getElementById('gross_profit').value = profit.toFixed(2);
}

function sellingexpense() {
            var selling = parseFloat(document.getElementById('general_and_administrative_expenses').value) || 0;
            var marketing = parseFloat(document.getElementById('selling_and_marketing_expense').value) || 0;

            var total = selling + marketing;
            document.getElementById('selling_general_and_administrative_expense').value = total.toFixed(2);
        }


    function marketing(){
    var selling=parseFloat(document.getElementById('general_and_administrative_expenses').value) || 0;
    var marketing=parseFloat(document.getElementById('selling_and_marketing_expense').value) || 0;
    var research=parseFloat(document.getElementById('research_and_development_expense').value) || 0;

    if(selling !==null && marketing !==null && research !==null){
        researchtotal=selling+marketing+research;
        document.getElementById('operating_expense').value=researchtotal.toFixed(2)
    }
    var grossprofit=parseFloat(document.getElementById('gross_profit').value)|| 0;
    var operating=parseFloat(document.getElementById('operating_expense').value) ||0
    var operatingincome=grossprofit-operating
    document.getElementById('operating_income').value=operatingincome.toFixed(2)
    }


    function operatingincome(){
        var nonoperating=parseFloat(document.getElementById('interest_income_non_operating').value) || 0;
        var expenseoperating=parseFloat(document.getElementById('interest_expense_non_operating').value) || 0;

        var interest=nonoperating-expenseoperating
        document.getElementById('net_non_operating_interest_income_expense').value=interest.toFixed(2)
        
        
    }

    function expenseincome(){
        var gain=parseFloat(document.getElementById('gain_or_loss_on_sale_of_security').value) || 0;
        var special=parseFloat(document.getElementById('special_income_or_charges').value) || 0;
        var write=parseFloat(document.getElementById('write_off').value) || 0;
        var other=parseFloat(document.getElementById('other_non_operating_income_or_expenses').value) || 0;

        incomeother=gain+special+write+other
        document.getElementById('other_income_or_expense').value=incomeother.toFixed(2)

        var incomeoperating=parseFloat(document.getElementById('operating_income').value) || 0;
        var net=parseFloat(document.getElementById('net_non_operating_interest_income_expense').value) || 0;
        var pretaxincome=incomeoperating+net+incomeother

        document.getElementById('pretax_income').value=pretaxincome.toFixed(2)


        var tax_provision=parseFloat(document.getElementById('tax_provision').value)|| 0;
        document.getElementById('net_income').value=(pretaxincome-tax_provision).toFixed(2)

        var preference=parseFloat(document.getElementById('preference_share_dividends').value) || 0;
        var netincome=parseFloat( document.getElementById('net_income').value) || 0;

        document.getElementById('net_income_to_common_stockholders').value=(netincome-preference).toFixed(2)

        var equity = parseFloat(document.getElementById('equity_share_dividends').value) || 0;
            var common = parseFloat(document.getElementById('net_income_to_common_stockholders').value) || 0;
            var retainedEarnings = common - equity;
            document.getElementById('retained_earnings').value = retainedEarnings.toFixed(2);

            var numequity = parseFloat(document.getElementById('no_of_equity_shares').value) || 0;
            var basicEps = common / numequity;
            document.getElementById('basic_eps').value = basicEps.toFixed(2);

            var depreciation = parseFloat(document.getElementById('depreciation_and_amortization').value) || 0;
            var EBITDA = incomeoperating + depreciation;
            document.getElementById('EBITDA').value = EBITDA.toFixed(2);
    }

    
</script>
{% endblock content %}